<!doctype html>

<html>
<head>
	<title>Hi</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link href="/css/bootstrap.min.css" rel="stylesheet">
	<link href="/css/bootstrap-theme.min.css" rel="stylesheet">
	<link href="/css/main.css" type="text/css" rel="stylesheet">

	<script src="/js/jquery-1.11.0.js"></script>
	<script src="/js/sessionstorage.js"> </script>

	<script type="text/javascript">

	$(document).ready(() => {
		let friendsToggle = true;
		console.log("Logged in as: " + sessionStorage.getItem("user"));

		$('#showVisual1').click(() => {
			window.location.href = '/views/visual.html';
		});

		$('#showVisual2').click(() => {
			//$.ajax({
				const friends = Object.values(profiles)[sessionStorage.getItem("userIndex")][1]
				var i;
				for (i = 0; i < friends.length; i++)  {
					console.log(1);
					const p = document.createElement("P");
					const text = document.createTextNode(friends[i]);
					p.appendChild(text);
					document.getElementById('allprofiles').appendChild(p);
				}
			//});
		});

		$('#logout').click(() => {
			forget();
			window.location.href = '/index.html';
		});

		//getFriends
		$('#getTopTracks').click(() =>{
			console.log('Submit POST request to lastfm for friends');
			const uid = sessionStorage.getItem('uid');
			console.log(sessionStorage.getItem('uid'));
			if(friendsToggle == true){
				$.ajax({
					type : 'POST',
					url: '/topTracks',
					data: {
						user: uid
					},
					success: (data) => {
						let buffer = "";
						for(var song in data){
							buffer += "<li>" + data[song].name + "</li>";
						}
						$('#songList').html(buffer);
						$('#songList').show();
					},
					error: (code, message) => {
						console.log('Error Message: ' + message);
					}
				})
			}else{
				$('#songList').hide();
			}
		});
	});
	</script>
</head>

<body>
	<div>
		<p class="header"> </p>
		<p class="title"> Home </p>

		<p class="spacer" style="margin-top: 100px"> </p>
		<input id="username" class="textbox" type="text" placeholder="Interested in ..." required>
		<button id="showVisual1"> CREATE VISUAL 1</button>
		<button id="showVisual2"> CREATE VISUAL 2</button>
		<button id="getTopTracks"> GET Top Tracks </button>
		<ul>
			<div id="songList">
			</div>
		</ul>

		<div id="allprofiles"> </div>

		<button id="logout"> LOG OUT </button>

	</div>

</body>
</html>
